# 今日校园智能班主任助理

**时间**：2020.03.02 - 2020.03.08<br />
<br />![今日校园1.png](https://cdn.nlark.com/yuque/0/2020/png/1116087/1592880075614-52401f33-d4d3-4625-9727-54ece4a7642b.png#align=left&display=inline&height=445&margin=%5Bobject%20Object%5D&name=%E4%BB%8A%E6%97%A5%E6%A0%A1%E5%9B%AD1.png&originHeight=1649&originWidth=1642&size=56605&status=done&style=none&width=443)<br />[今日校园1.ai](https://www.yuque.com/attachments/yuque/0/2020/ai/1116087/1592880087360-d749a36b-d923-4c5b-8a4a-0e8b76a3ea46.ai?_lake_card=%7B%22uid%22%3A%221592880088125-0%22%2C%22src%22%3A%22https%3A%2F%2Fwww.yuque.com%2Fattachments%2Fyuque%2F0%2F2020%2Fai%2F1116087%2F1592880087360-d749a36b-d923-4c5b-8a4a-0e8b76a3ea46.ai%22%2C%22name%22%3A%22%E4%BB%8A%E6%97%A5%E6%A0%A1%E5%9B%AD1.ai%22%2C%22size%22%3A126775%2C%22type%22%3A%22application%2Fpostscript%22%2C%22ext%22%3A%22ai%22%2C%22progress%22%3A%7B%22percent%22%3A99%7D%2C%22status%22%3A%22done%22%2C%22percent%22%3A0%2C%22id%22%3A%22J2Yoj%22%2C%22card%22%3A%22file%22%7D)<br />
<br />
<br /> [今日校园任务组每日分工(1).xlsx](https://www.yuque.com/attachments/yuque/0/2020/xlsx/1116087/1592192344951-31dc315f-a746-4091-979f-c847bfbae41e.xlsx?_lake_card=%7B%22uid%22%3A%221592192344823-0%22%2C%22src%22%3A%22https%3A%2F%2Fwww.yuque.com%2Fattachments%2Fyuque%2F0%2F2020%2Fxlsx%2F1116087%2F1592192344951-31dc315f-a746-4091-979f-c847bfbae41e.xlsx%22%2C%22name%22%3A%22%E4%BB%8A%E6%97%A5%E6%A0%A1%E5%9B%AD%E4%BB%BB%E5%8A%A1%E7%BB%84%E6%AF%8F%E6%97%A5%E5%88%86%E5%B7%A5%281%29.xlsx%22%2C%22size%22%3A11430%2C%22type%22%3A%22application%2Fvnd.openxmlformats-officedocument.spreadsheetml.sheet%22%2C%22ext%22%3A%22xlsx%22%2C%22progress%22%3A%7B%22percent%22%3A99%7D%2C%22status%22%3A%22done%22%2C%22percent%22%3A0%2C%22id%22%3A%22svWxU%22%2C%22card%22%3A%22file%22%7D)<br />小米小爱开放平台[https://xiaoai.mi.com/documents/Home?type=/api/doc/render_markdown/SkillAccess/SkillDocument/CustomSkills/CustomSkillsMain#%E5%BC%80%E5%8F%91%E8%80%85%E6%8E%A5%E5%85%A5%E6%B5%81%E7%A8%8B](https://xiaoai.mi.com/documents/Home?type=/api/doc/render_markdown/SkillAccess/SkillDocument/CustomSkills/CustomSkillsMain#%E5%BC%80%E5%8F%91%E8%80%85%E6%8E%A5%E5%85%A5%E6%B5%81%E7%A8%8B)<br />叮咚开放平台[http://open.linglongtech.com/openweb/register/index](http://open.linglongtech.com/openweb/register/index)<br />天猫精灵开放平台[https://www.aligenie.com/doc/357554/hf8wog](https://www.aligenie.com/doc/357554/hf8wog)
<a name="ebZZm"></a>
# 任务安排
组长：潘焕新 （总体定向，收尾完善）<br />副组长：只生龙（辅助测试）<br />组员：郭佳、贺巧童、康晓妍、周矗鑫、邵静萍、魏春华、娄莎莎、杨雯晴、金友齐、毕浩天（部分基础代码）
<a name="OqxAc"></a>
## 任务一：知道当前班主任，有多少个请假
1、潘焕鑫理清代码思路，确定初始代码基础，对组员进行教学。<br />2、只生龙辅助组长修改代码，分配工作。<br />3、郭佳、贺巧童、康晓妍、周矗鑫、邵静萍负责初始模拟登陆的代码。<br />4、魏春华、娄莎莎、杨雯晴、金友齐、毕浩天负责提取请假人数的代码。
<a name="4hQWn"></a>
## 任务二：给定学生名字，自动完成批准请假或是驳回请假的工作（使用web端）
1、潘焕鑫理清代码思路，确定主体代码和给定学生名字查找部分代码，对组员进行教学。<br />2、只生龙辅助组长修改代码，分配工作。<br />3、郭佳、贺巧童、康晓妍、周矗鑫、邵静萍负责对于请假同学的批准和驳回判定代码。<br />4、魏春华、娄莎莎、杨雯晴、金友齐、毕浩天负责请假同学的批准和驳回的后续代码。
<a name="vBBYT"></a>
## 任务三：结合小爱同学，基于语音完成整个链条工作（暂时搁置）
<a name="40Vu9"></a>
## SpeechRecognition安装方法
pip install -i [https://pypi.tuna.tsinghua.edu.cn/simple](https://pypi.tuna.tsinghua.edu.cn/simple) SpeechRecognition
<a name="7bsn1"></a>
## pyaudio安装方法
python3.7环境不能直接通过pip install pyaudio来安装此模块<br />1.进入url [https://www.lfd.uci.edu/~gohlke/pythonlibs/#pyaudio](https://www.lfd.uci.edu/~gohlke/pythonlibs/#pyaudio)<br />2.选择相应的版本，其中cp37代表python版本号3.7，amd64代表64位<br />3.在anaconda prompt中选择进入下载有whl文件的位置，输入pip install +下载的文件带拓展名全称<br />4.pip install pyaudio验证安装
<a name="fqmnc"></a>
# 日志记录如下
<a name="0j0CE"></a>
## 2020/6/15
任务一基础部分完成<br />以下代码为登录代码
```python
time.sleep(1)
driver.find_element_by_xpath("//div[@id='ampHasNoLogin']/span").click()
time.sleep(1)
driver.find_element_by_xpath("//input[@type='text']").send_keys("2018000013")
driver.find_element_by_xpath("//input[@type='password']").click()
driver.find_element_by_xpath("//input[@type='password']").clear()
driver.find_element_by_xpath("//input[@type='password']").send_keys("qw123456")
driver.find_element_by_xpath("//div[@id='app']/div/div/div/div/div[2]/div/div[2]/div/div/div[4]/div/span").click()
```
<br />
<a name="ZicVl"></a>
## 2020/6/16
任务二基本完成<br />暂定未纠错主体函数如下
```python
def fankui(li):#反馈是否还有未审批
    reobj = re.compile(r'</td><td class=""><div title="[\s\S]*?" class="ivu-table-cell ivu-table-cell-ellipsis"><!----> <!----> <!----> <!----> <!----> <a title="([\s\S]*?)"><span>[\s\S]*?</span></a></div></td>', re.MULTILINE)
    for match in reobj.finditer(html):
        a=match.group(1)
        li.append(a)
def xiayiwei():#部分假条需要选择下一位审批员
        driver.find_element_by_xpath("//div[7]/div/div/div/span").click()
        time.sleep(1)
        driver.find_element_by_xpath("//li[6]").click()
        time.sleep(1)
        driver.find_element_by_xpath("/html/body/div[4]/div[2]/div[2]/div[3]/button[1]").click()
def pg_qingjia(li):#具体批改代码
    while True:
        fankui(li)
        if len(li) == 0:
            print('请假批改完毕')
            break 
        time.sleep(1)
        driver.find_element_by_xpath(u"(//a[contains(text(),'查看详情')])[3]").click()
        time.sleep(1)
        driver.find_element_by_xpath("/html/body/div[4]/div[2]/div[2]/div[3]/button[1]").click() or xiayiwei()
        time.sleep(1)
        driver.find_element_by_xpath("/html/body/div[10]/div[2]/div/div/div/div/div[3]/button[2]").click()
        time.sleep(1)
        driver.back()
        time.sleep(1)
```
<br />
<a name="qEIay"></a>
## 2020/6/17-19
对函数代码进行改错以及优化
```python
def _extract_names(html):
    """提取名字"""
    reobj = re.compile(r'</td><td class=""><div title="[\s\S]*?" class="ivu-table-cell ivu-table-cell-ellipsis"><!----> <!----> <!----> <!----> <!----> <a title="([\s\S]*?)"><span>[\s\S]*?</span></a></div></td>', re.MULTILINE)
    names = [match.group(1) for match in reobj.finditer(html)]
    return names
def _shenpi():
    list1 = []
    html = driver.page_source
    #判断是否需要选择下一位审批人，请假详情有需要选择下一位审批人和不需要两种情况
    reobj = re.compile(r'<div data-v-6dc7dd24="" class="form-group mb-10"><label data-v-6dc7dd24="" class="label">下一级([\s\S]*?)人：</label> <div data-v-6dc7dd24="" class="ivu-select ivu-select-single" style="width: 200px;"><div class="ivu-select-selection"><input type="hidden">  <span class="ivu-select-placeholder">请([\s\S]*?)择', re.MULTILINE)
    list1 = [match.group(1) for match in reobj.finditer(html)]
    if len(list1)>0:    
        driver.find_element_by_xpath("//span[contains(text(),'请选择')]").click()
        driver.find_element_by_xpath("//li[6]").click()
        time.sleep(1)
        driver.find_element_by_xpath("//button[@type='button']").click()
        time.sleep(1)
        driver.find_element_by_xpath("//button[@class='ivu-btn ivu-btn-primary ivu-btn-large']").click()
    else:
        time.sleep(1)
        driver.find_element_by_xpath("//button[@type='button']").click()
        time.sleep(1)
        driver.find_element_by_xpath("//button[@class='ivu-btn ivu-btn-primary ivu-btn-large']").click()
def pg_qingjia():
    while True:
        html = driver.page_source
        names = _extract_names(html)
        if len(names) == 0:
            print('请假批改完毕')
            break 
        time.sleep(2)
        #模拟点击查看详情
        driver.find_element_by_xpath("/html/body/div[4]/div[2]/div[2]/div/div[2]/div[1]/div/div[3]/div/div/div[5]/div[2]/table/tbody/tr[1]/td[1]/div").click()
        time.sleep(1)
        _shenpi()
        time.sleep(1)
        driver.back()
# driver.back()在此处功能相当于driver.get("https://zjiet.cpdaily.com/wec-counselor-leave-apps/leaveadmin/pcAdmin/index.html#/list")
        time.sleep(1)
```
<a name="P338K"></a>
## 2020/6/20/24
py代码完成，在原本的基础上新增可指定名字单个批准请假的部分

<a name="OdZ6f"></a>
## 功德簿
| **人员** | **工作** | **贡献** |
| --- | --- | --- |
| 潘焕新（组长） | 前期总体定向、修改测试、完善代码，后期优化拓展 | 优 |
| 只生龙（副组长） | 辅助组长工作、分配工作 | 良 |
| 邵静萍 | 提取人数代码，logo设计制作 | 良 |
| 杨雯晴 | 整理汇总代码 | 良 |
| 魏春华 | 提取名字函数部分代码 | 中 |
| 娄莎莎 | 反馈是否还有未审批代码 | 中 |
| 郭佳 | 自动批改函数中下一位审批人代码 | 中 |
| 贺巧童 | 自动批改函数中请假批改完毕代码 | 中 |
| 康晓妍 | 自动批改函数中查看详情代码 | 中 |
| 毕浩天 | 提取名字函数部分代码 | 及格 |
| 金友齐 | 打开网页，登录页面代码 | 及格 |
| 周矗鑫 | 请假页面代码 | 及格 |

[岗前培训1.ai](https://www.yuque.com/attachments/yuque/0/2020/ai/1116087/1592880097425-d730275c-4cd1-4607-a792-8c9acfb2de4c.ai?_lake_card=%7B%22uid%22%3A%221592880098100-0%22%2C%22src%22%3A%22https%3A%2F%2Fwww.yuque.com%2Fattachments%2Fyuque%2F0%2F2020%2Fai%2F1116087%2F1592880097425-d730275c-4cd1-4607-a792-8c9acfb2de4c.ai%22%2C%22name%22%3A%22%E5%B2%97%E5%89%8D%E5%9F%B9%E8%AE%AD1.ai%22%2C%22size%22%3A132521%2C%22type%22%3A%22application%2Fpostscript%22%2C%22ext%22%3A%22ai%22%2C%22progress%22%3A%7B%22percent%22%3A99%7D%2C%22status%22%3A%22done%22%2C%22percent%22%3A0%2C%22id%22%3A%22itjjO%22%2C%22card%22%3A%22file%22%7D)<br />![岗前培训1.png](https://cdn.nlark.com/yuque/0/2020/png/1116087/1592880102739-e3d6950c-45be-46b6-b311-5a7618cec300.png#align=left&display=inline&height=83&margin=%5Bobject%20Object%5D&name=%E5%B2%97%E5%89%8D%E5%9F%B9%E8%AE%AD1.png&originHeight=1649&originWidth=1642&size=45141&status=done&style=none&width=83)
<a name="mFLUy"></a>
# 文件
[SchoolToday_yuan.py](https://www.yuque.com/attachments/yuque/0/2020/py/1116087/1592967484585-d5e63c2f-efac-42c9-a969-1132aae6b8c7.py?_lake_card=%7B%22uid%22%3A%221592967485618-0%22%2C%22src%22%3A%22https%3A%2F%2Fwww.yuque.com%2Fattachments%2Fyuque%2F0%2F2020%2Fpy%2F1116087%2F1592967484585-d5e63c2f-efac-42c9-a969-1132aae6b8c7.py%22%2C%22name%22%3A%22SchoolToday_yuan.py%22%2C%22size%22%3A5025%2C%22type%22%3A%22%22%2C%22ext%22%3A%22py%22%2C%22progress%22%3A%7B%22percent%22%3A99%7D%2C%22status%22%3A%22done%22%2C%22percent%22%3A0%2C%22id%22%3A%22SmNp1%22%2C%22card%22%3A%22file%22%7D)
<a name="pYFdy"></a>
# 点评
请给出团队贡献排名，建议的优良中及格分布，组长是谁，副组长是谁
